/* TraitCard component styles */
.card-trait {
  background: var(--color-parchment-50);
  border: 0.0625rem solid oklch(from var(--category-border) l c h / 0.5);
  border-radius: var(--radius-md);
  cursor: pointer;
  display: flex;
  flex-direction: column;
  padding: var(--space-3) var(--space-4) var(--space-4);
  position: relative;
  transition: all var(--transition-fast);
  user-select: none;
}

.card-trait:hover:not(.disabled) {
  background: var(--color-card-bg-hover);
  border-color: var(--color-ink-700);
  box-shadow: var(--shadow-md);
}

.card-trait:focus-visible {
  outline: 0.125rem solid var(--color-accent);
  outline-offset: 0.125rem;
}

.card-trait.selected {
  background-color: var(--color-card-bg-selected);
  outline: 0.0625rem solid var(--category-border);
  border-color: var(--category-border);
  box-shadow: var(--shadow-sm), inset 0.1875rem 0 var(--category-border);
}

.card-trait.selected:hover,
.card-trait.selected:focus-visible,
.card-trait.selected:active {
  box-shadow: var(--shadow-sm), inset 0.1875rem 0 var(--category-border);
}

.card-trait.disabled {
  background: var(--color-parchment-100);
  color: var(--color-ink-500);
  cursor: default;
}

.card-trait.disabled:hover {
  transform: none;
  box-shadow: none;
}

/* Locked state - selected but can't be deselected (required category) */
.card-trait.locked {
  cursor: default;
}

.card-trait.locked:hover {
  box-shadow: var(--shadow-sm), inset 0.1875rem 0 var(--category-border);
}

.card-trait.required:not(:has(.option.selected)) {
  outline: 0.0625rem solid var(--color-warning);
  box-shadow: var(--shadow-sm), inset 0.1875rem 0 var(--color-warning);
}

.card-trait.required:not(:has(.option.selected)):hover,
.card-trait.required:not(:has(.option.selected)):focus-visible,
.card-trait.required:not(:has(.option.selected)):active {
  outline: 0.0625rem solid var(--color-warning);
  box-shadow: var(--shadow-sm), inset 0.1875rem 0 var(--color-warning);
}

.card-trait:not(.selected) .pill.required {
  background: var(--pill-bg-required);
  color: var(--pill-text-required);
}

.card-trait:not(.selected):hover .pill.required,
.card-trait:not(.selected):focus-visible .pill.required,
.card-trait:not(.selected):active .pill.required {
  background: var(--color-warning);
  color: white;
}

.card-trait:not(.selected) .pill.cost {}

.card-trait:not(.selected):hover .pill.cost,
.card-trait:not(.selected):focus-visible .pill.cost,
.card-trait:not(.selected):active .pill.cost {
  background: oklch(from var(--pill-bg-cost) l c h / 0.72);
  color: white;
}

/* ── Header ────────────────────────────────── */
.card-trait .header {
  align-items: center;
  display: flex;
  gap: var(--space-2);
  justify-content: space-between;
  margin-bottom: var(--space-1);
}

.card-trait .name {
  font-family: var(--font-heading);
  font-size: 1rem;
  font-weight: 700;
  color: var(--color-ink-900);
  margin: 0.0625rem 0 0 0;
  /* font-variation-settings: 'opsz' 16; */
  line-height: var(--leading-tight);
}

.card-trait .name .selected-option {
  color: var(--color-heritage);
}

.card-trait.disabled .name {
  color: var(--color-ink-300);
}

/* ── Description ───────────────────────────── */
.card-trait .description {
  font-size: 0.9375rem;
  color: var(--color-ink-800);
  line-height: var(--leading-normal);
  margin: 0;
  padding-right: var(--space-8);
}

.card-trait .description a {
  font-style: italic;
  color: var(--category-background-light);
}

.card-trait .description a:hover,
.card-trait .description a:focus-visible,
.card-trait .description a:active {
  color: var(--category-background-light-hover);
  text-decoration: underline;
  text-decoration-thickness: 0.125rem;
  text-decoration-color: oklch(from var(--category-background-light) l c h);
}

.card-trait.disabled .description {
  color: var(--color-ink-400);
}

.card-trait .disabled-reason {
  margin-top: var(--space-2);
  padding: var(--space-1) var(--space-2);
  background: var(--color-warning-bg);
  border-radius: var(--radius-sm);
  font-family: var(--font-ui);
  font-size: var(--text-xs);
  color: var(--color-warning);
}

.card-trait .pill.requirement,
.card-trait .pill.restriction {
  margin-top: var(--space-1);
  margin-left: -0.25rem;
}

/* ── Options section ───────────────────────── */
.card-trait.has-options.selected .indicator {
  display: none;
}

.card-trait .options {
  margin-top: var(--space-3);
  padding-top: var(--space-3);
  border-top: 0.0625rem solid var(--color-parchment-300);
}

.card-trait .options-label {
  font-family: var(--font-ui);
  font-size: var(--text-xs);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--color-ink-600);
  margin-bottom: var(--space-2);
}

.card-trait .option {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  gap: var(--space-2);
  padding: var(--space-3);
  margin-bottom: var(--space-1);
  background: var(--color-parchment-100);
  border: 0.0625rem solid var(--color-parchment-400);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.card-trait .option:hover {
  background: var(--color-parchment-200);
  border-color: var(--color-ink-400);
}

.card-trait .option.selected {
  background-color: var(--color-card-bg-selected);
  outline: 0.0625rem solid var(--color-heritage);
  border-color: var(--color-heritage);
  box-shadow: inset 0.1875rem 0 var(--color-heritage);
}

.card-trait .option-radio {
  margin-top: 0.3125rem;
  accent-color: var(--color-heritage);
}

.card-trait .option-content-container {
  display: flex;
  flex: 1;
  flex-direction: column;
  gap: var(--space-1);
}

.card-trait .option-content {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  flex: 1;
}

.card-trait .option-name {
  display: flex;
  flex: 1;
  font-family: var(--font-heading);
  font-size: var(--text-base);
  font-weight: 700;
  color: var(--color-ink-800);
}

.card-trait .option-desc {
  width: 100%;
  font-size: var(--text-sm);
  color: var(--color-ink-500);
  line-height: var(--leading-relaxed);
}

/* ── Compact mode ──────────────────────────── */
.card-trait.compact {
  flex: 1;
  padding: var(--space-2) var(--space-3);
}

.card-trait.compact .indicator {
  display: none;
}

.card-trait.compact .header {
  margin-bottom: 0;
}

.card-trait.compact .name {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.card-trait.compact .indicator {
  width: 20px;
  height: 20px;
  font-size: var(--text-sm);
  bottom: 50%;
  transform: translateY(50%);
}

.card-trait.compact.selected,
.card-trait.compact.required:not(:has(.option.selected)) {
  box-shadow: var(--shadow-sm);
}

.main.at-budget .card-trait:not(.selected):not(:has(.core-attribute .pill.free)) {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

/* ── Highlight flash animation (for scroll-to) ─── */
@keyframes highlight-flash {

  0%,
  100% {
    box-shadow: var(--shadow-sm), inset 0.1875rem 0 var(--color-heritage);
  }

  15%,
  45%,
  75% {
    box-shadow: 0 0 0 4px var(--color-accent), inset 0.1875rem 0 var(--color-heritage);
  }

  30%,
  60%,
  90% {
    box-shadow: var(--shadow-sm), inset 0.1875rem 0 var(--color-heritage);
  }
}

.card-trait.highlight-flash {
  animation: highlight-flash 1.2s ease-out;
}